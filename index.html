<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adhkar - أذكار</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Scheherazade+New:wght@400;700&display=swap" rel="stylesheet">

    <!-- Custom Styles -->
    <style>
        /* Base font settings */
        body {
            font-family: 'Inter', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }
        .font-quran {
            font-family: 'Scheherazade New', serif;
        }

        /* NEW: Minimalist Reader Theme with Blue Accent */
        :root {
            --bg-light: #ffffff;
            --text-light: #202020;
            --secondary-text-light: #707070;
            --accent-light: #2563eb; 
            --border-light: #f0f0f0;

            --bg-dark: #181818;
            --text-dark: #f0f0f0;
            --secondary-text-dark: #a0a0a0;
            --accent-dark: #3b82f6;
            --border-dark: #2f2f2f;
        }

        body {
            background-color: var(--bg-light);
            color: var(--text-light);
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        .dark body {
            background-color: var(--bg-dark);
            color: var(--text-dark);
        }

        /* Header and Footer styles */
        .ui-panel {
            background-color: var(--bg-light);
            border-color: var(--border-light);
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }
        .dark .ui-panel {
            background-color: var(--bg-dark);
            border-color: var(--border-dark);
        }

        /* Title text color */
        .title-text {
            color: var(--text-light);
            font-weight: 600;
        }
        .dark .title-text {
            color: var(--text-dark);
        }
        
        /* Adhkar Section styles */
        .dhikr-section {
            border-bottom: 1px solid var(--border-light);
            padding: 1.75rem 0;
        }
        .dark .dhikr-section {
            border-bottom-color: var(--border-dark);
        }
        .dhikr-section:last-child {
            border-bottom: none;
        }

        /* Counter styles */
        .counter-circle {
            width: 40px;
            height: 40px;
            border: 2px solid var(--border-light);
            color: var(--secondary-text-light);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        .dark .counter-circle {
            border-color: var(--border-dark);
            color: var(--secondary-text-dark);
        }
        .dhikr-section.completed .counter-circle {
            background-color: var(--accent-light);
            border-color: var(--accent-light);
            color: white;
        }
        .dark .dhikr-section.completed .counter-circle {
            background-color: var(--accent-dark);
            border-color: var(--accent-dark);
            color: var(--bg-dark);
        }
        
        /* Active Tab Icon Color */
        .nav-tab.active-tab {
            color: var(--accent-light);
        }
        .dark .nav-tab.active-tab {
             color: var(--accent-dark);
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar { width: 5px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: rgba(120, 120, 120, 0.5); border-radius: 10px; }
    </style>
</head>
<body class="antialiased">

    <div id="app-container" class="min-h-screen flex flex-col font-sans">

        <!-- Header Section -->
        <header class="ui-panel sticky top-0 z-20 border-b w-full">
            <div class="p-4 flex justify-between items-center max-w-6xl mx-auto">
                <h1 class="text-2xl font-bold title-text" data-translate="app_title">Adhkar</h1>
                <div class="flex items-center space-x-2 text-[var(--text-light)] dark:text-[var(--text-dark)]">
                    <div class="relative">
                        <select id="language-switcher" class="appearance-none bg-transparent border-none text-gray-500 dark:text-gray-400 text-sm font-medium focus:outline-none p-2 rounded-md hover:bg-black/5 dark:hover:bg-white/5">
                            <option value="en">EN</option>
                            <option value="ar">AR</option>
                            <option value="fr">FR</option>
                        </select>
                    </div>
                    <button id="font-size-decrease" class="p-2 rounded-full hover:bg-black/5 dark:hover:bg-white/5 focus:outline-none focus:ring-2 ring-offset-2 ring-[var(--accent-light)] dark:ring-[var(--accent-dark)]">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12H4" /></svg>
                    </button>
                    <button id="font-size-increase" class="p-2 rounded-full hover:bg-black/5 dark:hover:bg-white/5 focus:outline-none focus:ring-2 ring-offset-2 ring-[var(--accent-light)] dark:ring-[var(--accent-dark)]">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" /></svg>
                    </button>
                    <button id="theme-toggle" class="p-2 rounded-full hover:bg-black/5 dark:hover:bg-white/5 focus:outline-none focus:ring-2 ring-offset-2 ring-[var(--accent-light)] dark:ring-[var(--accent-dark)]">
                        <svg id="theme-icon-light" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" /></svg>
                        <svg id="theme-icon-dark" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" /></svg>
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main id="main-content" class="flex-grow w-full max-w-3xl mx-auto p-4 md:p-6 lg:p-8 pb-24">
            <!-- Adhkar content will be injected here -->
        </main>

        <!-- Bottom Navigation -->
        <nav class="fixed bottom-0 left-0 right-0 ui-panel border-t z-20">
            <div class="flex justify-around items-center h-16 max-w-md mx-auto">
                <button class="nav-tab flex flex-col items-center justify-center w-full text-gray-500 dark:text-gray-400" data-tab="morning">
                    <svg class="h-6 w-6 mb-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M17 18a5 5 0 0 0-10 0"/>
                      <line x1="12" y1="2" x2="12" y2="9"/>
                      <line x1="4.22" y1="10.22" x2="5.64" y2="11.64"/>
                      <line x1="1" y1="18" x2="3" y2="18"/>
                      <line x1="21" y1="18" x2="23" y2="18"/>
                      <line x1="18.36" y1="11.64" x2="19.78" y2="10.22"/>
                      <line x1="23" y1="22" x2="1" y2="22"/>
                      <polyline points="8 6 12 2 16 6"/>
                    </svg>
                    <span class="text-xs font-medium" data-translate="morning_tab">Morning</span>
                </button>
                <button class="nav-tab flex flex-col items-center justify-center w-full text-gray-500 dark:text-gray-400" data-tab="evening">
                     <svg class="h-6 w-6 mb-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M17 18a5 5 0 0 0-10 0"/>
                      <line x1="12" y1="9" x2="12" y2="2"/>
                      <line x1="4.22" y1="10.22" x2="5.64" y2="11.64"/>
                      <line x1="1" y1="18" x2="3" y2="18"/>
                      <line x1="21" y1="18" x2="23" y2="18"/>
                      <line x1="18.36" y1="11.64" x2="19.78" y2="10.22"/>
                      <line x1="23" y1="22" x2="1" y2="22"/>
                      <polyline points="16 5 12 9 8 5"/>
                    </svg>
                    <span class="text-xs font-medium" data-translate="evening_tab">Evening</span>
                </button>
                <button class="nav-tab flex flex-col items-center justify-center w-full text-gray-500 dark:text-gray-400" data-tab="bedtime">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
                    </svg>
                    <span class="text-xs font-medium" data-translate="bedtime_tab">Bedtime</span>
                </button>
            </div>
        </nav>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            
            // --- DATA with Hadith References in English ---
            const fullAdhkarData = {
                ayatAlKursi: 'اللَّهُ لَا إِلَـٰهَ إِلَّا هُوَ الْحَيُّ الْقَيُّومُ ۚ لَا تَأْخُذُهُ سِنَةٌ وَلَا نَوْمٌ ۚ لَهُ مَا فِي السَّمَاوَاتِ وَمَا فِي الْأَرْضِ ۗ مَنْ ذَا الَّذِي يَشْفَعُ عِندَهُ إِلَّا بِإِذْنِهِ ۚ يَعْلَمُ مَا بَيْنَ أَيْدِيهِمْ وَمَا خَلْفَهُمْ ۖ وَلَا يُحِيطُونَ بِشَيْءٍ مِّنْ عِلْمِهِ إِلَّا بِمَا شَاءَ ۚ وَسِعَ كُرْسِيُّهُ السَّمَاوَاتِ وَالْأَرْضَ ۖ وَلَا يَئُودُهُ حِفْظُهُمَا ۚ وَهُوَ الْعَلِيُّ الْعَظِيمُ',
                alIkhlas: 'قُلْ هُوَ اللَّهُ أَحَدٌ ۝ اللَّهُ الصَّمَدُ ۝ لَمْ يَلِدْ وَلَمْ يُولَدْ ۝ وَلَمْ يَكُن لَّهُ كُفُوًا أَحَدٌ',
                alFalaq: 'قُلْ أَعُوذُ بِرَبِّ الْفَلَقِ ۝ مِن شَرِّ مَا خَلَقَ ۝ وَمِن شَرِّ غَاسِقٍ إِذَا وَقَبَ ۝ وَمِن شَرِّ النَّفَّاثَاتِ فِي الْعُقَدِ ۝ وَمِن شَرِّ حَاسِدٍ إِذَا حَسَدَ',
                anNas: 'قُلْ أَعُوذُ بِرَبِّ النَّاسِ ۝ مَلِكِ النَّاسِ ۝ إِلَٰهِ النَّاسِ ۝ مِن شَرِّ الْوَسْوَاسِ الْخَنَّاسِ ۝ الَّذِي يُوَسْوِسُ فِي صُدُurِ النَّاسِ ۝ مِنَ الْجِنَّةِ وَالنَّاسِ',
                radheetu: 'رَضِيتُ بِاللَّهِ رَبًّا، وَبِالإِسْلَامِ دِينًا، وَبِمُحَمَّدٍ صَلَّى اللهُ عَلَيْهِ وَسَلَّمَ نَبِيًّا',
                shahadaVariant: 'اللَّهُمَّ إِنِّي {variant} أُشْهِدُكَ، وَأُشْهِدُ حَمَلَةَ عَرْشِكَ، وَمَلَائِكَتَكَ، وَجَمِيعَ خَلْقِكَ، أَنَّكَ أَنْتَ اللَّهُ، لَا إِلَهَ إِلَّا أَنْتَ، وَحْدَكَ لَا شَرِيكَ لَكَ، وَأَنَّ مُحَمَّدًا عَبْدُكَ وَرَسُولُكَ',
                gratitudeVariant: 'اللَّهُمَّ مَا {variant} بِي مِنْ نِعْمَةٍ أَوْ بِأَحَدٍ مِنْ خَلْقِكَ، فَمِنْكَ وَحْدَكَ لَا شَرِيكَ لَكَ، فَلَكَ الْحَمْدُ وَلَكَ الشُّكْرُ',
                hasbiyallah: 'حَسْبِيَ اللَّهُ لَا إِلَهَ إِلَّا هُوَ، عَلَيْهِ تَوَكَّلْتُ، وَهُوَ رَبُّ الْعَرْشِ الْعَظِيمِ',
                duaDistress: 'اللَّهُمَّ إِنِّي أَعُوذُ بِكَ مِنَ الْهَمِّ وَالْحَزَنِ، وَالْعَجْزِ وَالْكَسَلِ، وَالْبُخْلِ وَالْجُبْنِ، وَضَلَعِ الدَّيْنِ، وَغَلَبَةِ الرِّجَالِ',
                istighfar: 'أَسْتَغْفِرُ اللَّهَ وَأَتُوبُ إِلَيْهِ',
                salat: 'اللَّهُمَّ صَلِّ عَلَى مُحَمَّدٍ وَعَلَى آلِ مُحَمَّدٍ كَمَا صَلَّيْتَ عَلَى إِبْرَاهِيمَ وَعَلَى آلِ إِبْرَاهِيمَ، إِنَّكَ حَمِيدٌ مَجِيدٌ',
                sayyidulIstighfar: 'اللَّهُمَّ أَنْتَ رَبِّي، لَا إِلَهَ إِلَّا أَنْتَ، خَلَقْتَنِي وَأَنَا عَبْدُكَ، وَأَنَا عَلَى عَهْدِكَ وَوَعْدِكَ مَا اسْتَطَعْتُ، أَعُوذُ بِكَ مِنْ شَرِّ مَا صَنَعْتُ، أَبُوءُ لَكَ بِنِعْمَتِكَ عَلَيَّ، وَأَبُوءُ لَكَ بِذَنْبِي، فَاغْفِرْ لِي، فَإِنَّهُ لَا يَغْفِرُ الذُّنُوبُ إِلَّا أَنْتَ',
            };
            const fullGetDhikrList = (period) => {
                const list = {
                    morning: [
                        { id: 'm1', arabic: fullAdhkarData.ayatAlKursi, translation: { en: 'Ayat Al-Kursi. Whoever recites it in the morning will be protected from the jinn until the evening, and whoever recites it in the evening will be protected from them until the morning. [Al-Hakim]', fr: 'Ayat Al-Kursi (Al-Baqara: 255)' }, count: 1 },
                        { id: 'm2', arabic: fullAdhkarData.alIkhlas, translation: { en: 'Surah Al-Ikhlas. Whoever recites them three times in the morning and in the evening, they will suffice him against everything. [Abu Dawud, Tirmidhi]', fr: 'Sourate Al-Ikhlas' }, count: 3 },
                        { id: 'm3', arabic: fullAdhkarData.alFalaq, translation: { en: 'Surah Al-Falaq. (Recite three times)', fr: 'Sourate Al-Falaq' }, count: 3 },
                        { id: 'm4', arabic: fullAdhkarData.anNas, translation: { en: 'Surah An-Nas. (Recite three times)', fr: 'Sourate An-Nas' }, count: 3 },
                        { id: 'm5', arabic: fullAdhkarData.radheetu, translation: { en: 'I am pleased with Allah as my Lord, with Islam as my religion, and with Muhammad (ﷺ) as my Prophet. Allah will be pleased with him on the Day of Resurrection. [Ahmad]', fr: 'Je suis satisfait d\'Allah comme mon Seigneur...' }, count: 3 },
                        { id: 'm6', arabic: fullAdhkarData.shahadaVariant.replace('{variant}', 'أَصْبَحْتُ'), translation: { en: 'O Allah, I have entered the morning and call You to witness... that You are Allah. Whoever says this four times, Allah will ransom him from the Fire. [Abu Dawud]', fr: 'Ô Allah, je suis entré dans le matin...' }, count: 4 },
                        { id: 'm7', arabic: fullAdhkarData.gratitudeVariant.replace('{variant}', 'أَصْبَحَ'), translation: { en: 'O Allah, whatever blessing I have is from You alone. Whoever says this has fulfilled the thankfulness of his day. [Abu Dawud]', fr: 'Ô Allah, toute bénédiction reçue...' }, count: 1 },
                        { id: 'm8', arabic: fullAdhkarData.hasbiyallah, translation: { en: 'Allah is sufficient for me... He is the Lord of the Majestic Throne. Allah will suffice him against whatever concerns him. [Abu Dawud]', fr: 'Allah me suffit...' }, count: 7 },
                        { id: 'm9', arabic: 'اللَّهُمَّ بِكَ أَصْبَحْنَا، وَبِكَ أَمْسَيْنَا، وَبِكَ نَحْيَا، وَبِكَ نَمُوتُ، وَإِلَيْكَ النُّشُورُ', translation: { en: 'O Allah, by You we enter the morning and by You we enter the evening...', fr: 'Ô Allah, par Toi nous entrons dans le matin...' }, count: 1 },
                        { id: 'm10', arabic: fullAdhkarData.duaDistress, translation: { en: 'O Allah, I seek refuge in You from anxiety and sorrow, weakness and laziness...', fr: 'Ô Allah, je cherche refuge auprès de Toi contre l\'anxiété...' }, count: 1 },
                        { id: 'm11', arabic: fullAdhkarData.istighfar, translation: { en: 'I seek the forgiveness of Allah and repent to Him.', fr: 'Je demande pardon à Allah...' }, count: 100 },
                        { id: 'm12', arabic: fullAdhkarData.salat, translation: { en: 'Salat upon the Prophet (ﷺ). Whoever sends blessings upon me once, Allah will send ten blessings upon him. [Muslim]', fr: 'Salat sur le Prophète (ﷺ)' }, count: 10 },
                        { id: 'm13', arabic: fullAdhkarData.sayyidulIstighfar, translation: { en: 'The Master of Seeking Forgiveness. Whoever says it with conviction in the evening and dies during that night will enter Paradise. [Bukhari]', fr: 'Sayyidul Istighfar' }, count: 1 },
                    ],
                    evening: [
                        { id: 'e1', arabic: fullAdhkarData.ayatAlKursi, translation: { en: 'Ayat Al-Kursi. Whoever recites it in the evening will be protected from the jinn until the morning. [Al-Hakim]', fr: 'Ayat Al-Kursi (Al-Baqara: 255)' }, count: 1 },
                        { id: 'e2', arabic: fullAdhkarData.alIkhlas, translation: { en: 'Surah Al-Ikhlas. Whoever recites them three times in the morning and in the evening, they will suffice him against everything. [Abu Dawud, Tirmidhi]', fr: 'Sourate Al-Ikhlas' }, count: 3 },
                        { id: 'e3', arabic: fullAdhkarData.alFalaq, translation: { en: 'Surah Al-Falaq. (Recite three times)', fr: 'Sourate Al-Falaq' }, count: 3 },
                        { id: 'e4', arabic: fullAdhkarData.anNas, translation: { en: 'Surah An-Nas. (Recite three times)', fr: 'Sourate An-Nas' }, count: 3 },
                        { id: 'e5', arabic: fullAdhkarData.radheetu, translation: { en: 'I am pleased with Allah as my Lord, with Islam as my religion, and with Muhammad (ﷺ) as my Prophet. Allah will be pleased with him on the Day of Resurrection. [Ahmad]', fr: 'Je suis satisfait d\'Allah comme mon Seigneur...' }, count: 3 },
                        { id: 'e6', arabic: fullAdhkarData.shahadaVariant.replace('{variant}', 'أَمْسَيْتُ'), translation: { en: 'O Allah, I have entered the evening and call You to witness... that You are Allah. Whoever says this four times, Allah will ransom him from the Fire. [Abu Dawud]', fr: 'Ô Allah, je suis entré dans la soirée...' }, count: 4 },
                        { id: 'e7', arabic: fullAdhkarData.gratitudeVariant.replace('{variant}', 'أَمْسَى'), translation: { en: 'O Allah, whatever blessing I have is from You alone. Whoever says this has fulfilled the thankfulness of his night. [Abu Dawud]', fr: 'Ô Allah, toute bénédiction reçue...' }, count: 1 },
                        { id: 'e8', arabic: fullAdhkarData.hasbiyallah, translation: { en: 'Allah is sufficient for me... He is the Lord of the Majestic Throne. Allah will suffice him against whatever concerns him. [Abu Dawud]', fr: 'Allah me suffit...' }, count: 7 },
                        { id: 'e9', arabic: 'اللَّهُمَّ بِكَ أَمْسَيْنَا، وَبِكَ أَصْبَحْنَا، وَبِكَ نَحْيَا، وَبِكَ نَمُوتُ، وَإِلَيْكَ الْمَصِيرُ', translation: { en: 'O Allah, by You we enter the evening and by You we enter the morning...', fr: 'Ô Allah, par Toi nous entrons dans la soirée...' }, count: 1 },
                        { id: 'e10', arabic: fullAdhkarData.duaDistress, translation: { en: 'O Allah, I seek refuge in You from anxiety and sorrow, weakness and laziness...', fr: 'Ô Allah, je cherche refuge auprès de Toi contre l\'anxiété...' }, count: 1 },
                        { id: 'e11', arabic: fullAdhkarData.istighfar, translation: { en: 'I seek the forgiveness of Allah and repent to Him.', fr: 'Je demande pardon à Allah...' }, count: 100 },
                        { id: 'e12', arabic: fullAdhkarData.salat, translation: { en: 'Salat upon the Prophet (ﷺ). Whoever sends blessings upon me once, Allah will send ten blessings upon him. [Muslim]', fr: 'Salat sur le Prophète (ﷺ)' }, count: 10 },
                        { id: 'e13', arabic: fullAdhkarData.sayyidulIstighfar, translation: { en: 'The Master of Seeking Forgiveness. Whoever says it with conviction in the evening and dies during that night will enter Paradise. [Bukhari]', fr: 'Sayyidul Istighfar' }, count: 1 },
                    ],
                    bedtime: [
                        { id: 'b1', arabic: 'يَجْمَعُ كَفَّيْهِ ثُمَّ يَنْفُثُ فِيهِمَا فَيَقْرأُ فِيهِمَا: ' + `"${fullAdhkarData.alIkhlas}", "${fullAdhkarData.alFalaq}", "${fullAdhkarData.anNas}"` + ' ثُمَّ يَمْسَحُ بِهِمَا مَا اسْتَطَاعَ مِنْ جَسَدِهِ... (3 مرات)', translation: { en: 'Cup hands, blow, recite Al-Ikhlas, Al-Falaq, An-Nas, then wipe over body. (3 times)', fr: 'Joindre les mains, souffler, réciter Al-Ikhlas, Al-Falaq, An-Nas, puis essuyer le corps. (3 fois)' }, count: 3 },
                        { id: 'b2', arabic: fullAdhkarData.ayatAlKursi, translation: { en: 'Ayat Al-Kursi. Whoever recites this when going to bed, a guardian from Allah will remain with him. [Bukhari]', fr: 'Ayat Al-Kursi' }, count: 1 },
                        { id: 'b3', arabic: 'آمَنَ الرَّسُولُ بِمَا أُنزِلَ إِلَيْهِ مِن رَّبِّهِ وَالْمُؤْمِنُونَ... (الآيتان الأخيرتان من سورة البقرة)', translation: { en: 'The last two verses of Surah Al-Baqarah. They will be sufficient for him. [Bukhari, Muslim]', fr: 'Les deux derniers versets de la sourate Al-Baqarah' }, count: 1 },
                        { id: 'b4', arabic: 'بِاسْمِكَ رَبِّ وَضَعْتُ جَنْبِي، وَبِكَ أَرْفَعُهُ...', translation: { en: 'In Your name my Lord, I place my side...', fr: 'En Ton nom mon Seigneur, je pose mon côté...' }, count: 1 },
                        { id: 'b5', arabic: 'اللَّهُمَّ قِنِي عَذَابَكَ يَوْمَ تَبْعَثُ عِبَادَكَ', translation: { en: 'O Allah, save me from Your punishment on the day You resurrect Your slaves. (3 times)', fr: 'Ô Allah, sauve-moi de Ton châtiment... (3 fois)' }, count: 3 },
                        { id: 'b6', arabic: 'سُبْحَانَ اللَّهِ (33 مرة)، الْحَمْدُ لِلَّهِ (33 مرة)، اللَّهُ أَكْبَرُ (34 مرة)', translation: { en: 'SubhanAllah (33), Alhamdulillah (33), Allahu Akbar (34). This is better for you than a servant. [Bukhari, Muslim]', fr: 'SubhanAllah (33), Alhamdulillah (33), Allahu Akbar (34)' }, count: 1 },
                    ]
                };
                return list[period];
            };
            const fullTranslations = {
                en: { app_title: 'Adhkar', morning_tab: 'Morning', evening_tab: 'Evening', bedtime_tab: 'Bedtime', translation_label: 'Translation', reset: 'Reset' },
                ar: { app_title: 'أذكار', morning_tab: 'الصباح', evening_tab: 'المساء', bedtime_tab: 'النوم', translation_label: 'ترجمة', reset: 'إعادة' },
                fr: { app_title: 'Adhkar', morning_tab: 'Matin', evening_tab: 'Soir', bedtime_tab: 'Nuit', translation_label: 'Traduction', reset: 'Réinitialiser' }
            };

            // --- STATE ---
            let currentState = {
                language: 'en',
                theme: 'light',
                activeTab: 'morning',
                fontSize: 16,
                arabicFontSize: 20, // Initial Arabic font size
            };

            // --- DOM ELEMENTS ---
            const mainContent = document.getElementById('main-content');
            const navTabs = document.querySelectorAll('.nav-tab');
            const themeToggle = document.getElementById('theme-toggle');
            const themeIconLight = document.getElementById('theme-icon-light');
            const themeIconDark = document.getElementById('theme-icon-dark');
            const langSwitcher = document.getElementById('language-switcher');
            const fontSizeIncrease = document.getElementById('font-size-increase');
            const fontSizeDecrease = document.getElementById('font-size-decrease');

            // --- FUNCTIONS ---
            function renderAdhkar() {
                const dhikrList = fullGetDhikrList(currentState.activeTab);
                mainContent.innerHTML = '';
                
                dhikrList.forEach(dhikr => {
                    const card = document.createElement('div');
                    card.className = 'dhikr-section relative cursor-pointer';
                    card.dataset.id = dhikr.id;
                    card.dataset.total = dhikr.count;
                    card.dataset.current = dhikr.count;

                    card.innerHTML = `
                        <p class="font-quran text-right leading-loose mb-4" style="font-size: ${currentState.arabicFontSize}px;">${dhikr.arabic}</p>
                        <div class="flex justify-between items-end">
                            <p class="translation-text text-[var(--secondary-text-light)] dark:text-[var(--secondary-text-dark)] pr-4 flex-1" style="font-size: ${currentState.fontSize}px;">
                                <span class="font-semibold opacity-80" data-translate="translation_label"></span>: ${dhikr.translation[currentState.language]}
                            </p>
                            <div class="counter-circle">
                                <span class="count-value font-semibold text-lg">${dhikr.count}</span>
                            </div>
                        </div>
                    `;
                    mainContent.appendChild(card);
                });
                updateTranslations();
            }

            function updateTranslations() {
                document.querySelectorAll('[data-translate]').forEach(el => {
                    const key = el.dataset.translate;
                    el.textContent = fullTranslations[currentState.language][key] || el.textContent;
                });
                document.documentElement.lang = currentState.language;
                document.documentElement.dir = currentState.language === 'ar' ? 'rtl' : 'ltr';
                
                navTabs.forEach(tab => {
                    tab.classList.remove('active-tab');
                    if (tab.dataset.tab === currentState.activeTab) {
                        tab.classList.add('active-tab');
                    }
                });
            }

            function switchTab(tabName) {
                currentState.activeTab = tabName;
                renderAdhkar();
                mainContent.scrollTop = 0;
            }

            function toggleTheme() {
                currentState.theme = currentState.theme === 'light' ? 'dark' : 'light';
                if (currentState.theme === 'dark') {
                    document.documentElement.classList.add('dark');
                    themeIconLight.classList.add('hidden');
                    themeIconDark.classList.remove('hidden');
                } else {
                    document.documentElement.classList.remove('dark');
                    themeIconLight.classList.remove('hidden');
                    themeIconDark.classList.add('hidden');
                }
                localStorage.setItem('theme', currentState.theme);
            }
            
            function changeFontSize(direction) {
                if (direction === 'increase') {
                    if (currentState.fontSize < 22) currentState.fontSize++;
                    if (currentState.arabicFontSize < 36) currentState.arabicFontSize += 2;
                } else if (direction === 'decrease') {
                    if (currentState.fontSize > 12) currentState.fontSize--;
                    if (currentState.arabicFontSize > 18) currentState.arabicFontSize -= 2;
                }
                
                document.querySelectorAll('.translation-text').forEach(el => {
                    el.style.fontSize = `${currentState.fontSize}px`;
                });
                document.querySelectorAll('.font-quran').forEach(el => {
                    el.style.fontSize = `${currentState.arabicFontSize}px`;
                });

                localStorage.setItem('fontSize', currentState.fontSize);
                localStorage.setItem('arabicFontSize', currentState.arabicFontSize);
            }

            function handleCardClick(e) {
                const section = e.target.closest('.dhikr-section');
                if (!section || section.classList.contains('completed')) return;

                let currentCount = parseInt(section.dataset.current);
                const countValueEl = section.querySelector('.count-value');

                if (currentCount > 0) {
                    currentCount--;
                    section.dataset.current = currentCount;
                    countValueEl.textContent = currentCount;

                    if (currentCount === 0) {
                        section.classList.add('completed', 'opacity-50');
                        countValueEl.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7" /></svg>`;
                    }
                }
            }

            function init() {
                const savedTheme = localStorage.getItem('theme') || 'light';
                if (savedTheme === 'dark') {
                    currentState.theme = 'dark';
                    document.documentElement.classList.add('dark');
                    themeIconLight.classList.add('hidden');
                    themeIconDark.classList.remove('hidden');
                }

                currentState.fontSize = parseInt(localStorage.getItem('fontSize')) || 16;
                currentState.arabicFontSize = parseInt(localStorage.getItem('arabicFontSize')) || 20;
                currentState.language = localStorage.getItem('language') || 'en';
                langSwitcher.value = currentState.language;

                switchTab('morning');

                navTabs.forEach(tab => tab.addEventListener('click', () => switchTab(tab.dataset.tab)));
                themeToggle.addEventListener('click', toggleTheme);
                langSwitcher.addEventListener('change', (e) => {
                    currentState.language = e.target.value;
                    localStorage.setItem('language', e.target.value);
                    renderAdhkar();
                });
                fontSizeIncrease.addEventListener('click', () => changeFontSize('increase'));
                fontSizeDecrease.addEventListener('click', () => changeFontSize('decrease'));
                mainContent.addEventListener('click', handleCardClick);
            }

            init();
        });
    </script>
</body>
</html>
